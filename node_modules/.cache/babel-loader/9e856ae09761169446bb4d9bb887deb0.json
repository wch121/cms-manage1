{"ast":null,"code":"var _jsxFileName = \"D:\\\\vs code\\\\project\\\\aka\\\\cms\\\\cms-manage\\\\cms-manage1\\\\src\\\\pages\\\\Means.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { Button, Form, Input, message, Upload } from 'antd';\nimport { LoadingOutlined, PlusOutlined } from '@ant-design/icons';\nimport { ChangeUserInfoApi } from 'request/api';\n// import { connect } from 'react-redux'\n// import { Dispatch } from 'redux'\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Means(props) {\n  _s();\n  const [loading, setLoading] = useState(false);\n  const [imageUrl, setImageUrl] = useState(\"\");\n  const onFinish = values => {\n    console.log('Success:', values);\n    //调接口，修改用户名和密码\n    ChangeUserInfoApi({\n      username: values.username || '',\n      password: values.password || ''\n    }).then(res => {\n      if (res.errCode === 0) {\n        message.success(res.message);\n        let {\n          avatar,\n          username\n        } = res.data;\n        //存储用户信息\n        localStorage.setItem(\"avatar\", avatar);\n        localStorage.setItem(\"username\", username);\n        localStorage.setItem(\"cms-token\", res.data['cms-token']);\n        //更新header的组件.走react-redux\n        props.changeKeyFn();\n      }\n      if (res.errCode === 1) {\n        message.warning(res.message);\n      }\n    });\n  };\n  const beforeUpload = file => {\n    const isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png';\n    if (!isJpgOrPng) {\n      message.error('You can only upload JPG/PNG file!');\n    }\n    const isLt2M = file.size / 1024 / 1024 < 2;\n    if (!isLt2M) {\n      message.error('Image must smaller than 2MB!');\n    }\n    return isJpgOrPng && isLt2M;\n  };\n\n  //上传按钮\n  const UploadButton = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [loading ? /*#__PURE__*/_jsxDEV(LoadingOutlined, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 18\n    }, this) : /*#__PURE__*/_jsxDEV(PlusOutlined, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 40\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 8\n      },\n      children: \"Upload\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 5\n  }, this);\n\n  //onchange调用的函数\n  const handleChange = info => {\n    if (info.file.status === 'uploading') {\n      setLoading(true);\n      return;\n    }\n    if (info.file.status === 'done') {\n      console.log(info.file);\n      if (info.file.response.errCode === 0) {\n        message.success(\"头像修改成功\");\n        //存储用户信息\n        localStorage.setItem('avatar', info.file.response.data.avatar);\n        localStorage.setItem('username', info.file.response.data.username);\n        localStorage.setItem('cms-token', info.file.response.data['cms-token']);\n        //更新Header组件\n        props.changeKeyFn();\n      }\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Form, {\n      style: {\n        width: '400px'\n      },\n      name: \"basic\",\n      initialValues: {\n        remember: true\n      },\n      onFinish: onFinish,\n      autoComplete: \"on\",\n      children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n        label: \"Username\",\n        name: \"username\",\n        children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n        label: \"Password\",\n        name: \"password\",\n        children: /*#__PURE__*/_jsxDEV(Input.Password, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n        wrapperCol: {\n          offset: 20,\n          span: 16\n        },\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          htmlType: \"submit\",\n          children: \"\\u63D0\\u4EA4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Upload, {\n      name: \"avatar\",\n      listType: \"picture-card\",\n      className: \"avatar-uploader\",\n      showUploadList: false,\n      action: process.env.SERVE_POST + \"/manage/upload\",\n      headers: {\n        \"cms-token\": localStorage.getItem('cms-token')\n      },\n      beforeUpload: beforeUpload,\n      onChange: handleChange,\n      children: imageUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n        src: imageUrl,\n        alt: \"avatar\",\n        style: {\n          width: '100%'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(UploadButton, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 85\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 5\n  }, this);\n}\n\n// const mapDispatchToProps = (dispatch: Dispatch) => {\n//   return {\n//     changeKeyFn() {\n//       dispatch({ type: \"changeKey\" })\n//     }\n//   }\n// }\n\n// export default connect(null, mapDispatchToProps)(Means)\n_s(Means, \"7yQhdChm1Mdi1pob2qgJNn4VZG8=\");\n_c = Means;\nvar _c;\n$RefreshReg$(_c, \"Means\");","map":{"version":3,"names":["React","useState","Button","Form","Input","message","Upload","LoadingOutlined","PlusOutlined","ChangeUserInfoApi","Means","props","loading","setLoading","imageUrl","setImageUrl","onFinish","values","console","log","username","password","then","res","errCode","success","avatar","data","localStorage","setItem","changeKeyFn","warning","beforeUpload","file","isJpgOrPng","type","error","isLt2M","size","UploadButton","marginTop","handleChange","info","status","response","width","remember","offset","span","process","env","SERVE_POST","getItem"],"sources":["D:/vs code/project/aka/cms/cms-manage/cms-manage1/src/pages/Means.tsx"],"sourcesContent":["import React, { useState } from 'react'\nimport { Button, Form, Input, message, Upload } from 'antd';\nimport { LoadingOutlined, PlusOutlined } from '@ant-design/icons';\nimport { ChangeUserInfoApi } from 'request/api'\n// import { connect } from 'react-redux'\n// import { Dispatch } from 'redux'\n\ninterface IProps {\n  changeKeyFn: () => void;\n}\n\nfunction Means(props: IProps) {\n  const [loading, setLoading] = useState(false)\n  const [imageUrl, setImageUrl] = useState(\"\")\n  const onFinish = (values: any) => {\n    console.log('Success:', values);\n    //调接口，修改用户名和密码\n    ChangeUserInfoApi({\n      username: values.username || '',\n      password: values.password || '',\n    }).then((res: any) => {\n      if (res.errCode === 0) {\n        message.success(res.message);\n        let { avatar, username } = res.data;\n        //存储用户信息\n        localStorage.setItem(\"avatar\", avatar)\n        localStorage.setItem(\"username\", username)\n        localStorage.setItem(\"cms-token\", res.data['cms-token'])\n        //更新header的组件.走react-redux\n        props.changeKeyFn();\n      }\n      if (res.errCode === 1) {\n        message.warning(res.message);\n      }\n    })\n  };\n\n  const beforeUpload = (file: any) => {\n    const isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png';\n    if (!isJpgOrPng) {\n      message.error('You can only upload JPG/PNG file!');\n    }\n    const isLt2M = file.size / 1024 / 1024 < 2;\n    if (!isLt2M) {\n      message.error('Image must smaller than 2MB!');\n    }\n    return isJpgOrPng && isLt2M;\n  };\n  \n  //上传按钮\n  const UploadButton =()=> (\n    <div>\n      {loading ? <LoadingOutlined /> : <PlusOutlined />}\n      <div style={{ marginTop: 8 }}>Upload</div>\n    </div>\n  );\n\n  //onchange调用的函数\n  const handleChange = (info: any) => {\n    if (info.file.status === 'uploading') {\n      setLoading(true);\n      return;\n    }\n    if (info.file.status === 'done') {\n      console.log(info.file)\n      if(info.file.response.errCode===0){\n        message.success(\"头像修改成功\");\n        //存储用户信息\n        localStorage.setItem('avatar',info.file.response.data.avatar);\n        localStorage.setItem('username',info.file.response.data.username);\n        localStorage.setItem('cms-token',info.file.response.data['cms-token']);\n        //更新Header组件\n        props.changeKeyFn();\n      }\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div>\n      <Form\n        style={{ width: '400px' }}\n        name=\"basic\"\n        initialValues={{ remember: true }}\n        onFinish={onFinish}\n        autoComplete=\"on\"\n      >\n        <Form.Item\n          label=\"Username\"\n          name=\"username\"\n        >\n          <Input />\n        </Form.Item>\n\n        <Form.Item\n          label=\"Password\"\n          name=\"password\"\n        >\n          <Input.Password />\n        </Form.Item>\n\n        <Form.Item wrapperCol={{ offset: 20, span: 16 }}>\n          <Button type=\"primary\" htmlType=\"submit\">提交</Button>\n        </Form.Item>\n      </Form>\n      <Upload\n        name=\"avatar\"\n        listType=\"picture-card\"\n        className=\"avatar-uploader\"\n        showUploadList={false}\n        action={process.env.SERVE_POST+\"/manage/upload\"}\n        headers={{ \"cms-token\": localStorage.getItem('cms-token') as string }}\n        beforeUpload={beforeUpload}\n        onChange={handleChange}\n      >\n        {imageUrl ? <img src={imageUrl} alt=\"avatar\" style={{ width: '100%' }} /> : <UploadButton />}\n      </Upload>\n    </div>\n  )\n}\n\n// const mapDispatchToProps = (dispatch: Dispatch) => {\n//   return {\n//     changeKeyFn() {\n//       dispatch({ type: \"changeKey\" })\n//     }\n//   }\n// }\n\n// export default connect(null, mapDispatchToProps)(Means)"],"mappings":"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"},"metadata":{},"sourceType":"module"}